# æ¦‚è¿°
å­¦ä¹ å½±ç‰‡æ¥æº 1ï¼š[Rust ç¼–ç¨‹è¯­è¨€å…¥é—¨æ•™ç¨‹ 2021](https://www.youtube.com/watch?v=e3-2uxHhbzs&list=PL3azK8C0kje1DUJbaOqce19j3R_-tIc4_)

å­¦ä¹ å½±ç‰‡æ¥æº 2ï¼š[From Python to Rust](https://www.youtube.com/watch?v=7odJDwhjCXQ&list=PLEIv4NBmh-GsWGE9mY3sF9c5lgh5Z_jLr)



# åŸºæœ¬æ¦‚å¿µ
+ å˜é‡
+ æ•°æ®ç±»å‹
    + æ ‡é‡ç±»å‹
    + å¤åˆç±»å‹
+ å‡½æ•°
+ æ³¨é‡Š
+ æ§åˆ¶æµ

## 1.1 å˜é‡ä¸å¯å˜æ€§
ä½¿ç”¨ `let` å£°æ˜å˜é‡ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å¯è¢«ä¿®æ”¹(immutable)çš„ä¸€ä¸ªå€¼ï¼Œä¾‹å¦‚

```rust
let x = 5;
x = 10;
```

æ­£ç¡®çš„åšæ³•æ˜¯åœ¨å‰é¢åŠ ä¸Š `mut` å…³é”®è¯ï¼š

```rust
let mut x = 5;
x = 10;
```

## 1.2 å˜é‡ä¸å¸¸é‡
1. å¸¸é‡ä¸å¯ä»¥ç”¨ `mut`ï¼Œç¡®ä¿å…¶ä¸å˜æ€§
2. ä½¿ç”¨ `const` å£°æ˜ï¼Œç±»å‹å¿…é¡»è¢«æ ‡æ³¨
3. å¸¸é‡å¯ä»¥åœ¨å…¨å±€ä»»æ„åœ°æ–¹è¢«åˆ›å»ºï¼ˆå£°æ˜ï¼‰ï¼ŒåŒ…æ‹¬å…¨å±€ä½œç”¨åŸŸ
4. ç¨‹åºè¿è¡ŒæœŸé—´ï¼Œå¸¸é‡æ°¸è¿œæœ‰æ•ˆ
5. ä¸€èˆ¬ä»¥å…¨å¤§å†™å‘½åï¼Œå•è¯ä¹‹é—´ç”¨`_`åˆ†å¼€

```rust
const x:i32 = 5;
```

## 1.3 éšè—å˜é‡ï¼ˆshadowingï¼‰
å¯ä»¥ç”¨ä¹‹å‰ç”¨è¿‡çš„å˜é‡åé‡æ–°å£°æ˜ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œæ—§çš„å°±ä¼šè¢«éšè—ï¼ˆè¦†ç›–æ‰ï¼‰

```rust
let x = 5;
let x = x + 1;
let x = 10;
```

è¿™ä¹ˆæ“ä½œåï¼Œæ–°çš„å˜é‡åŒæ ·è¿˜æ˜¯ä¸å¯å˜çš„ï¼Œå’Œ `mut` æƒ…å†µä¸åŒï¼Œè€Œä¸”æ–°çš„å˜é‡æ•°æ®ç±»å‹åœ¨è¿™ç§æ–¹æ³•ä¸‹ä¹Ÿæ˜¯å¯ä»¥æ”¹çš„ï¼Œä¾‹å¦‚ï¼š

```rust
let space = "abcde";      // &str type
let space = space.len();  //  i32 type
```

## 2.1 æ•°æ®ç±»å‹
`rust` æ˜¯ä¸€ç§é™æ€ç¼–è¯‘è¯­è¨€ï¼Œå¯ä»¥åˆ†æˆä¸¤ç±»æ•°æ®ç±»å‹ï¼šæ ‡é‡ & å¤åˆç±»å‹ï¼Œç¼–è¯‘çš„æ—¶å€™éœ€è¦çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ï¼Œç®€å•çš„æƒ…å†µå¯ä»¥è‡ªåŠ¨æ¨æ–­å‡ºæ•°æ®çš„ç±»å‹å¹¶è‡ªåŠ¨èµ‹äºˆï¼Œä½†å¦‚æœç±»å‹æ¯”è¾ƒå¤æ‚ï¼Œå°±éœ€è¦æ‰‹åŠ¨æ ‡æ˜ï¼Œä¾‹å¦‚

```rust
let guess: u32 = "42".parse().expect("not a number");
println!("guess: {}", guess);
```

`rust` è¯­è¨€é‡Œçš„æ ‡é‡ç±»å‹åˆ†æˆï¼šæ•´æ•°ï¼Œæµ®ç‚¹ï¼Œå¸ƒå°”ï¼Œå­—ç¬¦ å››ç§ç±»å‹

### 2.1.1 æ•´æ•° & æµ®ç‚¹
æ•´æ•°ç±»å‹æ²¡æœ‰å°æ•°éƒ¨åˆ†ï¼Œæ²¡æœ‰ç¬¦å· (`-`) çš„æ•´æ•°ä»¥ u å¼€å¤´ï¼Œæœ‰çš„è¯å°±ä»¥ i å¼€å¤´

| Length | Signed | Unsigned | Float | Complex |
| --- | --- |  --- |  --- |  --- |
| 8-bit | `i8` | `u8` | $\times$ |  |
| 16-bit | `i16` | `u16` | `f16` |  |
| 32-bit | `i32` (default) | `u32` | `f32` |  |
| 64-bit | `i64` | `u64` |`f64` (default)  |  |
| 128-bit | `i128` | `u128` | $\times$ |  |
| arch | `isize` | `usize` | $\times$ |  |

+ `Signed`: $-2^{n-1}\sim 2^{n-1} - 1$. eg. i8 = -128 ~ 127
+ `Unsigned`: $0 \sim 2^{n} - 1$. eg. u8 = 0 ~ 255

| æ•´æ•°å­—é¢å€¼ | èŒƒä¾‹ |
| --- | --- |
| Decimal | `98_222` |
| Hex | `0xff` |
| Octal | `0o77` |
| Binary | `0b1111_0000` |
| Byte (u8 only) | `b'A'` |

æ‰€æœ‰çš„å­—é¢å€¼éƒ½å…è®¸ä½¿ç”¨ç±»å‹åç¼€ï¼ˆé™¤äº†byteé™¤å¤–ï¼‰ï¼Œä¾‹å¦‚ï¼š

```rust
let x = 35u8;
```

### 2.1.2 æº¢å‡º
å› ä¸ºä¸åŒ bit çš„æ•°æ®ç±»å‹æœ‰ä¸åŒçš„é•¿åº¦èŒƒå›´ï¼Œå¦‚æœæº¢å‡ºäº†ï¼Œåˆ™ä¼šå‡ºç°ä¸¤ç§æƒ…å†µï¼š
1. `debug` æ¨¡å¼ä¸‹ä¼šå‡ºç° `panic` æŠ¥é”™
2. `release` æ¨¡å¼ä¸‹ä¸ä¼šæœ‰æŠ¥é”™ï¼Œä½†ä¼šå¾ªç¯æ“ä½œï¼Œä¾‹å¦‚ 257 -> 1

### 2.1.3 è®¡ç®—æ“ä½œ
```rust
let sum = 5 + 10;       // 15   (i32)
let diff = 95.3 - 4.3;  // 91.0 (f64)
let prod = 30 * 40;     // 120  (i32)
let quot = 9.9 / 2.2;   // 4.5  (f64)
let rmdr = 9 % 5;       //  4   (i32)
```

### 2.1.4 å¸ƒå°”å½¢
```rust
let t = true;
let f: bool = false;
```

### 2.1.5 å­—ç¬¦ç±»å‹
æ˜¯è¯­è¨€ä¸­ç”¨æ¥æè¿°æœ€åŸºç¡€çš„å•ä¸ªå­—ç¬¦ï¼Œå­—é¢å€¼ä½¿ç”¨ `'a'` å•å¼•å·è¡¨ç¤ºï¼Œå ç”¨ 4 å­—èŠ‚å¤§å°ï¼Œæ˜¯ Unicode æ ‡é‡å€¼ï¼Œå¯ä»¥è¡¨ç¤ºæ¯”ASCIIå¤šçš„å­—ç¬¦å†…å®¹ï¼Œä¾‹å¦‚æ‹¼éŸ³ï¼Œä¸­æ—¥éŸ©æ–‡ï¼Œé›¶é•¿åº¦ç©ºç™½å­—ç¬¦ï¼Œemojiè¡¨æƒ…ç­‰
- `U+0000` ~ `U+D7FF`
- `U+E000` ~ `U+10FFF`

```rust
let x = 'a';
let u: char = 'Âµ';
let e = 'ğŸ˜‚';
```

## 2.2 å¤åˆç±»å‹
æ­¤ç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼æ”¾åœ¨åŒä¸€é¢ç±»å‹é‡Œï¼Œæœ‰ä¸¤ç§å½¢å¼
1. å…ƒç»„ - (tuple)
2. æ•°ç»„ - [array]

### 2.2.1 å…ƒç»„
å¯ä»¥å°†å¤šä¸ªå€¼åœ¨ä¸åŒæ•°æ®ç±»å‹çš„æƒ…å†µä¸‹æ”¾åœ¨ä¸€èµ·

```rust
let tup = (3u8, 5i16, 'a', true);
println!("tuple: {:?}", tup);
```

æ³¨æ„ï¼Œä¸€æ—¦å£°æ˜äº†ä¸€ä¸ªtupleä¹‹åï¼Œé•¿åº¦å°±æ˜¯å›ºå®šçš„ï¼Œæ— æ³•è¢«å¢é•¿æˆ–ç¼©çŸ­ï¼Œtupleé‡Œé¢çš„å€¼å¯ä»¥æ”¹å˜ï¼Œä½†ä¿®æ”¹çš„å†…å®¹ä»…é™äºä¸è¢«ä¿®æ”¹çš„æ•°æ®åŒä¸€ä¸ªæ•°æ®ç±»å‹çš„ä¸œè¥¿

```rust
let mut tup = (3u8, 5i16, 'a', true);
tup.2 = 'b';     // Correct
tup.2 = 100i32;  // Wrong
```

### 2.2.2 æ¨¡å¼åŒ¹é…ä¸ç´¢å¼•
å¯ä»¥ç›´æ¥ç”¨å¤šä¸ªå˜é‡åæ¥åŒ¹é…å…ƒç»„é‡Œçš„æ•°æ®

```rust
let tup2: (i32, f64, bool) = (500, 3.14, true);
let (x, y, z) = tup2;
```

ç´¢å¼•æ–¹å¼å°±æ˜¯ç”¨ `.?` çš„æ–¹å¼æ¥è·å–å¯¹åº”ä½ç½®çš„å€¼ï¼Œé¡ºåºä» 0 å¼€å§‹

### 2.2.3 æ•°ç»„
åŒæ ·å¯ä»¥å°†å¤šä¸ªå€¼æ”¾åœ¨ä¸€èµ·ï¼Œå£°æ˜ä¹‹åé•¿åº¦ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯è¦æ±‚è¿™äº›å€¼çš„æ•°æ®ç±»å‹å¿…é¡»ç›¸åŒï¼Œå£°æ˜æ–¹å¼ï¼š[ç±»å‹, é•¿åº¦]

```rust
let arr1 = [1, 2, 3, 4, 5];
let arr1: [i32, 5] = [1, 2, 3, 4, 5];
let mut arr2 = [8; 6];  // arr2: [8, 8, 8, 8, 8, 8]
```

å¦‚æœæƒ³å°†æ•°æ®å­˜æ”¾åœ¨ stack(æ ˆ-æ²¡æœ‰åœ°å€é€Ÿåº¦è¾ƒå¿«)ï¼Œå¹¶ä¸”å›ºå®šæ•°é‡çš„å…ƒç´ ï¼Œä½¿ç”¨æ•°ç»„å°†æ›´æœ‰å¥½å¤„ï¼Œä½†ä»–æ²¡æœ‰ Vector `vec!` çµæ´»ï¼Œåœ¨ä¸ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬æ¯”è¾ƒå¸¸ä½¿ç”¨ vectorï¼Œä¿®æ”¹æ–¹å¼å’Œå…ƒç»„ç±»ä¼¼

```rust
arr2[3] = 100;
```

### 2.2.4 æ¨¡å¼åŒ¹é…ä¸ç´¢å¼•
æ•°ç»„ä¸å…ƒç»„æœ‰ä¸€æ ·çš„æ¨¡å¼åŒ¹é…ä¸ç±»ä¼¼çš„ç´¢å¼•åŠŸèƒ½ï¼Œæ³¨æ„ä¸­æ‹¬å·

```rust
let [x1, x2, x3, x4, x5, x6] = arr2;
```

ç´¢å¼•çš„éƒ¨åˆ†å¹¶éç›´æ¥åœ¨åé¢åŠ æ•°å­—ï¼Œè€Œæ˜¯åœ¨ä¸­æ‹¬å·å†…å†™ä½ç½®ï¼Œä¸åŒçš„åœ°æ–¹æ˜¯æ•°ç»„å¯ä»¥ä¸€æ¬¡ç´¢å¼•å¤šä¸ªå€¼

```rust
println!("arr1: {:?}", arr1[1..4]);
```

ä¸è¿‡ï¼Œåœ¨ä¿®æ”¹ç´¢å¼•å‡ºæ¥çš„éƒ¨åˆ†å€¼çš„æ—¶å€™å¹¶ä¸èƒ½ç›´æ¥ä¸€æ¬¡ä¿®æ”¹

```rust
arr1[1..4] = [200, 300, 400];
```

å½“ç´¢å¼•çš„ä½ç½®è¶…è¿‡æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œç¼–è¯‘ä¼šé€šè¿‡ï¼Œä½†æ˜¯è¿è¡Œä¼šæŠ¥é”™ï¼ŒåŸå› å°±åœ¨äº `rust` ä¸å…è®¸å½“å‰æ“ä½œç´¢å¼•åˆ°åˆ«çš„ object å¯èƒ½å­˜æ”¾ä½ç½®çš„åœ°æ–¹å»ã€‚

```rust
// Case 1
let num = arr1[8];  // compile: error ; run: error

// Case 2
let idx = [8, 9, 10];
let num = arr1[idx[0]];  // compile; ok ; run: error
```

## 3.1 å‡½æ•°
ä¸€ä¸ªç¨‹åºé¡¹ç›®ä¸»è¦è¿è¡Œçš„å«åšä¸»ç¨‹åºï¼Œåªè¦å…¶ä»–å‡½æ•°å®šä¹‰å¥½äº†ï¼Œä¸è®ºä¸Šä¸‹é¡ºåºï¼Œéƒ½å¯ä»¥åœ¨ä¸»ç¨‹åºé‡Œè°ƒç”¨

```rust
fn func1() {
    println!("func1");
}

fn main() {
    println!("hello world");
    func1();
    func2(7, 3.14);  // Arguments
}

fn func2(x: i32, y: f64) -> f64 {  // Parameters
    println!("func2");
    // x as f64 + y     // Solution 1
    f64::from(x) + y    // Solution 2
    // return f64::from(x) + y  // OK
}
```

å‡½æ•°é‡Œçš„å‚æ•°å¿…é¡»å¼ºåˆ¶è®¾å®šæ•°æ®ç±»å‹ï¼Œå¦‚æœæœ‰ç»“æœè¾“å‡ºï¼Œä¹Ÿéœ€è¦å£°æ˜æ¸…æ¥šè¾“å‡ºçš„ç±»å‹ï¼Œè¾“å‡ºçš„æ•°æ®é»˜è®¤å°±æ˜¯æœ€åä¸€è¡Œçš„ç»“æœ

## 3.2 è¯­å¥ & è¡¨è¾¾å¼
ä¸€ç³»åˆ—çš„è¯­å¥ç»„æˆä¸€ä¸ªå‡½æ•°ï¼Œæœ€åå¯ä»¥ç”¨ä¸€ä¸ªè¡¨è¾¾å¼ç»“æŸï¼Œ`rust` æ˜¯ä¸€ä¸ªåŸºäºè¡¨è¾¾å¼çš„è¯­è¨€ï¼Œè¯­å¥æ˜¯æ‰§è¡Œä¸€äº›åŠ¨ä½œçš„æŒ‡ä»¤ï¼Œæœ€åè¡¨è¾¾å¼ä¼šè®¡ç®—äº§ç”Ÿä¸€ä¸ªå€¼ï¼Œä½œä¸ºå‡½æ•°è¿”å›çš„æ•°æ®ç»™åˆ°åˆ«çš„å˜é‡é‡Œã€‚ç”±äºè¯­å¥æ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸èƒ½å°†å…¶èµ‹å€¼ç»™å˜é‡ï¼Œä¾‹å¦‚

```rust
let y = (let y = 6);  // Wrong

let y = {
    let x = 1;
    x + 3
};
println!("y: {}", y);  // y: 4 (correct)
```

## 4.1 if è¡¨è¾¾å¼
`if` è¡¨è¾¾å¼å…è®¸æ ¹æ®æ¡ä»¶ (bool) æ‰§è¡Œä¸åŒçš„ä»£ç åˆ†æ”¯ï¼Œä¸æ¡ä»¶ç›¸å…³è”çš„ä»£ç å—å°±å«åˆ†æ”¯ (arm)

```rust
if condition1 {
    // do something ...
} else if condition2 {
    // do another thing ...
} else {
    // do last thing ...
}
```

ç”±äº `if` æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥è¢«æ”¾åœ¨ `let` å³è¾¹å†™æˆè¿™æ ·

```rust
let num1 = if condition { 5 } else { 6 };    // Correct
let num2 = if condition { 5 } else { "6" };  // Wrong
```

ç„¶è€Œï¼Œ`if` è¡¨è¾¾å¼è¦æ±‚ä¸åŒæƒ…å†µä¸‹è¿”å›çš„ä¸œè¥¿å¿…é¡»å¾—æ˜¯ä¸€ä¸ªç±»å‹çš„ä¸œè¥¿ï¼Œä¸ç„¶ä¼šæŠ¥é”™

## 4.2 å¾ªç¯è¯­å¥
å¾ªç¯åœ¨ `rust` ä¸­åˆ†æˆ `loop`, `for`, `while` ä¸‰ç§åšæ³•ï¼Œ

### 4.2.1 `loop` å¾ªç¯åˆ°åœ¨å¾ªç¯å†…éƒ¨å–Šåœä¸ºæ­¢

```rust
let mut cnt = 0;
let res = loop {
    cnt += 1;
    if cnt == 10 {
        // return a value while the loop is break
        break cnt * cnt;
    }
};
println!("res: {}", res);
```

### 4.2.2 `while` å¾ªç¯åˆ°æ»¡è¶³æ¡ä»¶ä¸ºæ­¢

```rust
let arr1 = [1, 2, 3, 4, 5];
let mut idx_arr = 0;

while idx < 5 {
    println!("arr1[{}] = {}", idx, arr1[idx]);
    idx += 1;
};
```

### 4.2.3 `for` å¾ªç¯

```rust
let arr1 = [1, 2, 3, 4, 5];
for elem in arr1.iter() {
    println!("elem: {}", elem);
};
```

è¿™ä¸‰ç§å¾ªç¯ `for` æ˜¯æœ€å¸¸ç”¨çš„ï¼Œå› ä¸ºå®ƒå®‰å…¨ä¸”ç®€ä»‹ï¼Œä¹Ÿä¸ä¼šé‡åˆ°è¶…å‡ºç´¢å¼•è¿™ç±»ä¸å¿…è¦çš„éº»çƒ¦ï¼Œè€Œä¸”è¿™äº›å¾ªç¯çš„ä¸œè¥¿è¿˜æœ‰å¾ˆå¤šæ–¹ä¾¿çš„æ¨¡å—ä¾‹å¦‚ `rev()` åè½¬åˆ—è¡¨

```rust
for num in (1..4).rev() {
    println!("num: {}", num);
};
```